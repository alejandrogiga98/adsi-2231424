<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Challenge Events Time</title>
   <link rel="stylesheet" href="css/styles.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
   <style>
      /* Generales */
      section section{
         *border: 1px solid red;
         height: 500px;
         margin: 0px auto;
         padding: 0px;
         width: 800px;
      }

      .oculto{
         display: none;
      }

      /* Pantalla Titulo */
      section.seccionTitulo{
         background: url(imgs/times/pantallaTitulo.png) no-repeat center;
         background-size: contain;
         position: relative;
      }

      section.seccionTitulo div.instrucciones{
         border: 1px solid #FFFFFF;
         background: #0d2f86dd;
         border-radius: 15px;
         box-sizing: border-box;
         height: 133px;
         width: 500px;
         position: absolute;
         left: 170px;
         top: 215px;
      }

      section.seccionTitulo div.instrucciones h3{
         *border: 1px solid red;
         background: none;
         color: #fff;
         font-family: Roboto;
         font-size: 35px;
         font-style: normal;
         font-weight: normal;
         line-height: 29px;
         text-decoration-line: underline;
         text-align: center;
      }

      section.seccionTitulo div.instrucciones h4{
         *border: 1px solid red;
         color: #FFFFFF;
         font-family: Roboto;
         font-size: 22px;
         font-style: normal;
         font-weight: normal;
         line-height: 25px;
         margin: -20px auto;
         text-align: center;
         width: 500px;
      }

      section.seccionTitulo button.iniciar{
         background: #276D89;
         *background: url(imgs/times/space1.jpg) repeat 0px 0px;
         border: 1px solid #FFFFFF;
         border-radius: 26px;
         box-sizing: border-box;
         color: #f09e42;
         font-size: 32px;
         
         font-weight: 700;
         height: 64px;
         width: 250px;
         position: absolute;
         left: 296px;
         top: 388px;
         transition: all 0.3s ease;
      }

      section.seccionTitulo button.iniciar:hover{
         transform: scale(1.2);
         background-color: #f09e42;
         border: 2px solid #800;
         color: rgb(17, 114, 17);
         cursor: pointer;
         *font-family: Arial, Helvetica, sans-serif;
      }

      section.seccionTitulo div.fondoInstrucciones{
         *border:1px solid red;
         border-radius: 15px;
         height: 133px;
         overflow: hidden;
         width: 500px;
         *z-index: 0;
         position: absolute;
         left: 170px;
         top: 215px;
      }

      section.seccionTitulo div.fondoInstrucciones div.parallax{
         *background: transparent url(imgs/times/space4.png) repeat 0px 0px;
         background: transparent url(imgs/times/space5.png) repeat 0px 0px;
         background-size: cover;
         height: 133px;
         *width: 500px;
         animation: 20s animParallaxTitulo linear infinite;
      }

      @keyframes animParallaxTitulo{
         0% { background-position: 0px 130px; }
         100% { background-position: -500px 130px; }
      }

      /* Pantalla Juego */
      section.seccionJuego{
         *border: 1px solid green;
         background: url(imgs/times/pantallaJuegoPNG.png) no-repeat center;
         background-size: cover;
         overflow: hidden;
         border-radius: 25px;
         position: relative;
      }

      section.seccionJuego div.zonaJuego{
         *border: 1px solid red;
         height: 362px;
         width: 800px;
      }

      /*section.seccionJuego div.zonaJuego div{
         background: url(imgs/times/samus.svg) no-repeat center;
         background-size: contain;
         *border: 1px solid white;
         margin: 0px -2px;
         display: inline-block;
         height: 120px;
         width: 160px;
      }  */

      section.seccionJuego div.estadisticas{
         *border: 1px solid blue;
         border-top: 10px solid #3583FF;
         height: 122px;
         width: 800px;
      }

      section.seccionJuego div.estadisticas div{
         *border: 1px solid green;
         height: 40px;
         padding: 0;
         width: 150px;
         position: absolute;
         top: 433px;
      }

      section.seccionJuego div.estadisticas div.puntaje{
         left: 180px;
      }

      section.seccionJuego div.estadisticas div.tiempo{
         left: 416px;
      }

      section.seccionJuego div.estadisticas div.energia{
         left: 656px;
      }

      section.seccionJuego div.estadisticas div h3{
         background: none;
         color: white;
         font-family: Roboto;
         font-style: normal;
         font-weight: normal;
         font-size: 42px;
         line-height: 40px;
         margin: 0px auto;
         padding: 0;
         text-align: center;
         text-shadow: #800 1px 1px 1px, #800 -1px -1px 3px;
      }

      section.seccionJuego div.zonaJuego div.samus{
         background: #15b url(imgs/times/samus.svg) no-repeat center;
         background-size: contain;
         *border: 1px solid red;
         height: 120px;
         width: 160px;
         position: absolute;
         top: 120px;
         transition: all 0.1s linear;
         animation: 0.8s animationSamus ease-in infinite;
      }
        
      @keyframes animationSamus {
         0%, 100% { left: 0px; }
         50% { left: 2px; }
      }

      section.seccionJuego div.zonaJuego div.enemigos{
         *border:1px solid red;
         background-size: contain;
         height: 120px;
         width: 160px;
         position: absolute;
         left: 640px;
         *left: 160px;
      }

      section.seccionJuego div.zonaJuego div.parallax{
         border: 1px solid green;
         background:transparent url(imgs/times/space1.jpg);
         height: 362px;
         width: 800px;
         animation: 3s animParallaxJuego linear infinite;
      }

      @keyframes animParallaxJuego {
            0%   { background-position: 0px 0px; }
            100% { background-position: -1000px 0px;    }
            
         /* 0% { background-position: 0px 130px; }
            100% { background-position: -500px 130px; } */
        }

      section.seccionJuego div.zonaJuego div.ridley{
         background: #fff url(imgs/times/enemigoRidley.svg) no-repeat center;
      }

      section.seccionJuego div.zonaJuego div.metroidVerde{
         background: #fff url(imgs/times/enemigoMetroidVerde.png) no-repeat center;
      }

      section.seccionJuego div.zonaJuego div.metroidBlanco{
         background: #fff url(imgs/times/enemigoMetroidBlanco.svg) no-repeat center;
      }

      section.seccionJuego div.zonaJuego div.darkSamus{
         background: #fff url(imgs/times/enemigoDarkSamus.svg) no-repeat center;
      }

   </style>
</head>
<body>
   <main>
      <header>
            <h1> <span> <a href="index.html">&larr;</a> </span> Challenge Events Time</h1>
      </header>
      <section>
         <!-- Seccion Titulo -->
         <section class="seccionTitulo animate__animated">
            <div class="instrucciones">
               <h3>Instrucciones</h3>
               <h4>Usa las flechas  ↑  y  ↓  para controlar el movimiento de Samus y evitar a todos los enemigos. Tienes 100 puntos de energia...  debes sobrevivir hasta que termine el tiempo.</h4>
            </div>
            <div class="fondoInstrucciones">
               <div class="parallax"></div>
            </div>
            <button class="iniciar">Iniciar Juego</button>
         </section> 
         <!-- Seccion Juego --> 
         <section class="seccionJuego oculto animate__animated">
            <div class="zonaJuego">
               <div class="samus"></div>
               <div class="enemigos"></div>
               <div class="parallax"></div>
            </div>
            <div class="estadisticas">
               <div class="puntaje"><h3 class="puntaje">0</h3></div>
               <div class="tiempo"><h3 class="tiempo">60</h3></div>
               <div class="energia"><h3 class="energia">100</h3></div>
            </div>
         </section>
      </section>
   </main>
   <audio src="audio/metroidDreadOSTThemeOfSamusAran.mp3" class="musicaTitulo"></audio>
   <audio src="audio/metroidDreadOSTCentralUnitPhase2.mp3" class="musicaJuego"></audio>
   <audio src="audio/colision.mp3" class="sonidoColision"></audio>
   <br>
   <script>
      const botonIniciar = document.querySelector('button.iniciar');
      const seccionTitulo = document.querySelector('section.seccionTitulo');
      const seccionJuego = document.querySelector('section.seccionJuego');
      const samus = document.querySelector('div.samus');
      const enemigos = document.querySelector('div.enemigos');
      const posicionEnemigosTop = [0, 120, 240];
      const posicionEnemigosLeft = [640, 480, 320, 160, 0];
      const nombreEnemigos = ['ridley', 'metroidVerde', 'darkSamus', 'metroidBlanco'];
      const musicaTitulo = document.querySelector('audio.musicaTitulo');
      const musicaJuego = document.querySelector('audio.musicaJuego');
      const sonidoColision = document.querySelector('audio.sonidoColision')
      var puntaje = document.querySelector('h3.puntaje');
      var tiempo = document.querySelector('h3.tiempo');
      var energia = document.querySelector('h3.energia');
      //var posicionLeftEnemigo= 640;

      //tiempoRestante=60;
      //puntos = 0;
      //posicionSamus=120;
      /*setInterval(function() {
         //console.log("Han pasado " + i + " segundos.");
         tiempoRestante--;
         
         tiempo.innerText = tiempoRestante;
         if(tiempoRestante % 3 == 0){
            puntos+=100;
            num = parseInt(puntaje);
            console.log(num);
            console.log(puntos);
            puntaje.innerText = puntos;
            //puntaje.innerText = parseInt(puntaje.value) + 100;
         }
      } , 1000); */

      // Objeto
      const juego = {
         // Atributos
         puntos: 0,
         tiempoRestante: 60,
         saludRestante: 100,
         posicionSamus: 120,
         posicionLeftEnemigo: 640,
         // Metodos
         correTiempo: function() {
            let intervalo = setInterval(function() {
               /* if (juego.tiempoRestante % 10 == 0) {
                  if (juego.tiempoRestante != 60) {
                     juego.puntos += 10;
                  }
               } */
               if (juego.tiempoRestante < 60 && juego.tiempoRestante > -1) {
                  if (juego.tiempoRestante % 10 == 0) {
                     juego.puntos += 100;
                  } else {
                     juego.puntos +10;
                  }
               }
               puntaje.innerText = juego.puntos;
               if (juego.tiempoRestante < 1) {
                  ///alert('El juego ha finalizado');
                  tiempo.innerText = '0';
                  clearInterval(intervalo);
               } else {
                  tiempo.innerText = juego.tiempoRestante--;
               }

            }, 1000);
         },
         aleatorioEnemigos: function() {
            let generacionEnemigos = setInterval(function(){
               //aleatorio entre 0 y <3 para la posicion de la lista de la posicion vertical del enemigo
               let randPos = Math.floor(Math.random() * posicionEnemigosTop.length);
               //aleatorio entre 0 y <4 para la posicion de la lista de nombres de enemigos
               let randNom = Math.floor(Math.random() * nombreEnemigos.length);
               enemigos.classList.remove(nombreEnemigos[0]);
               enemigos.classList.remove(nombreEnemigos[1]);
               enemigos.classList.remove(nombreEnemigos[2]);
               enemigos.classList.remove(nombreEnemigos[3]);
               enemigos.classList.add(nombreEnemigos[randNom]);
               enemigos.style.top = posicionEnemigosTop[randPos] + "px";
               juego.posicionLeftEnemigo = 640;
               //console.log(randPos + " - " + randNombre);
            }, 840);
            
            let movimientoEnemigos = setInterval(function(){
               //console.log("hellow peter");
               //if (juego.tiempoRestante % 2 == 0 && juego.tiempoRestante != 60){
                  //console.log(juego.tiempoRestante);
                  //enemigos.style.
                  //console.log(juego.posicionLeftEnemigo);
                  enemigos.style.left = juego.posicionLeftEnemigo + "px";
                  juego.posicionLeftEnemigo = juego.posicionLeftEnemigo-10;
               //}
            }, 10);

            let compararColision = setInterval(function(){
               console.log(enemigos.offsetTop);
               //if (juego.tiempoRestante<59 && samus.style.top == enemigos.style.top && (enemigos.style.left == "160px" || enemigos.style.left== "0px") ){
               //if (juego.tiempoRestante<59 && samus.offsetTop == enemigos.offsetTop && (enemigos.offsetLeft <= 160 ) ){
               if (juego.tiempoRestante<59 && samus.style.top == enemigos.style.top && (enemigos.style.left <= "160px") ){
                  //console.log(enemigos.style.left);
                  //console.log(juego.tiempoRestante);
                  //console.log("colision!!!");
                  console.log("Enemigos: " + enemigos.offsetLeft);
                  sonidoColision.currentTime = 0;
                  sonidoColision.play();
                  juego.saludRestante--;
                  energia.innerText= juego.saludRestante;
               }
            }, 10);

            setInterval(function(){

            }, 10);
         },
         iniciarMusicaJuego: function(){
            musicaJuego.currentTime = 0;
            //musicaJuego.play();
            musicaJuego.loop = true;
         },
         //musicaTitulo.CurrentTime(15);
         detenerMusicaTitulo: function(){
            musicaTitulo.pause();
         }
      }

      /* Eventos */
      botonIniciar.onclick = function(){
         //console.log("Entra al boton Iniciar");
         seccionTitulo.classList.add('animate__backOutUp');
         seccionJuego.classList.add('animate__backInUp');
         setTimeout(function() {
            seccionTitulo.classList.toggle("oculto");
            seccionJuego.classList.toggle("oculto");
         },500);
         setTimeout(function() {
            juego.correTiempo();
            juego.aleatorioEnemigos();
            juego.iniciarMusicaJuego();
            juego.detenerMusicaTitulo();
         },500);
      }

      //musicaTitulo.play();
      musicaTitulo.currentTime = 7;
      musicaTitulo.loop = true;
      
      
      document.onkeydown = function(event) {
         //console.log(event.keyCode);
         // left(37)  up(38)  right(39)  down(40)
         if(event.keyCode == 38) {
            if ( juego.posicionSamus > 0) {
               juego.posicionSamus -= 120;
               samus.style.top = juego.posicionSamus + 'px';
            }
         }
         if(event.keyCode == 40) {
            if ( juego.posicionSamus < 240) {
               juego.posicionSamus += 120;
               samus.style.top = juego.posicionSamus + 'px';
            }
         }
      }
      

   </script>
</body>
</html>